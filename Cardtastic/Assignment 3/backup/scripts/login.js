//blacklist obtained from: https://github.com/danielmiessler/SecLists/blob/master/Passwords/10k_most_common.txt and adapted for educational purposes
let blacklist = ["football","111111","ranger","killer","6969","william","freedom","taylor","martin","cowboy","scooter","peanut","boomer","black","booboo","scooby","monster","john","winter","johnson","rachel","qazwsx","butthead","madison","booger","forever","sierra","sandra","lucky","jaguar","canada","success","dolphins","cocacola","alex","rush2112","gordon","rebecca","bitches","4444","rock","frank","slut","jessie","nissan","kevin","therock","penis","nothing","buffalo","playboy","ford","genesis","carmen","drummer","hello1","mine","buddha","money1","denise","time","hard","paradise","norman","allison","marshall","nipples","ladies","pirate","natalie","smooth","bradley","cobra","admin","wolverin","pearljam","tony","bondage","rooster","8888","arizona","weasel","jenny","chevelle","roland","eugene","people","lisa","sandy","wolfpack","shaved","madmax","chronic","katie","tattoo","flowers","connie","women","vegeta","control","michele","bowling","nick","mmmmmm","sterling","harry","review","fuckit","fetish","gundam","awesome","gizmo","angel1","access14","asdf1234","cadillac","butt","colors","gold","island","basketba","indians","photos","hottie","abgrtyu","stone","99999999","stephani","sampson","nasty","snatch","hamilton","manson","brandi","planet","cavalier","nylons","savannah","frog","mariah","stud","irish","shan","audrey","hollywoo","nikita","ibanez","aragorn","father","chandler","viper1","funtime","jeep","slick","hungry","mission","orion","spunky","biggie","bush","skywalke","tarzan","sprite","sweetie","chou","mylove","tong","showme","toshiba","bigguy","tuan","shun","kennedy","andreas","keeper","martina","stonecol","chuang","kuai","pang","biao","suan","liao","lucas","muscle","zhen","shuo","qiong","zhuai","qwertz","preston","parrot","asdasd","blue22","spanking","2424","jersey","banshee","michel","wookie","deepthroat","pentium","engine","bacon","camel","fighter","ccbill","1967","boner","champs","carpet","ricardo","asdfghjkl","spiderman","national","darwin","puppy","nymets","chucky","horny1","abigail","7654321","hongkong","cash","22222","porter","letsgo","melvin","knights","mallard","golfing","surf","gerald","soccer1","breast","frances","silvia","heather1","jjjj","claude","theresa","honda1","tricky","falcons","lickit","loving","topper","oxford","billie","jammer","doodle","stoner","monopoly","fingers","blacky","fisting","student","frederic","kisses","eeeeee","backdoor","eternity","jennie","aggies","rockets","abcde","alfa","herbie","santiago","zorro","metal","1x2zkg8w","aaaaaaa","gangbang","broken","anders","sonic","buttman","lemons","dilligaf","pinkfloy","orioles","suckers","racer","rockhard","homer1","poncho","diver","studio","sapphire","imperial","macdaddy","leader","pppp","siemens","doughboy","conner","fugazi","momoney","catman","daniel1","bigtime","rotten","bender","greatone","kill","super1","123789","darling","woofwoof","f**k","elizabeth","jenny1","diamond1","milano","penetration","films","spawn","oooo","mouse1","labrador","desert","static","hailey","daddy1","sixty","cartoon","noodles","sniffing","closeup","tolkien","gofish","boris","pillow","goalie","nobody","sexy69","frisco","ne1469","senior","scout","cyclone","sinclair","groucho","tundra","skydive","having","davids","jayjay","canon","conover","warlord","journey","paradox","moose1","animated","homepage","spock","gunnar","science","booker","010203","leopard","anfield","hores","snapple","marker","force","housewifes","bigmoney","live","dimas","nacked","woohoo","barcelon","coconut","experienced","pitchers","hayley","qwert40","beastie","lisalisa","royals","bobobo","seamus","charlton","twins","momsuck","sheba","chico","presto","vietnam","march","panasoni","keywest","sullivan","angus","lotus","welder","pickup","hambone","underdog","beretta","rhino","dino","bullseye","pinky","goten","comet","misfit99","solution","scandinavian","yumyum","steeler","chemical","lllll","buckshot","zidane","riley","gaston","town","helmet","3x7pxr","lindros","card","pussyman","boxer","mortgage","assholes","lucky13","heat","biggles","jenn","seahawks","nuclear","bluedog","gonavy","uncencored","brett","piano","gromit","dorian","higgins","2727","spectre","hawaiian","royal","aaron1","jammin","passwort","1017","ppppp","holyshit","records","glow","confused","whatsup","south","hayabusa","cloud","mikey1","snuffy","antoine","magician","dell","everest","poochie","alibaba","passpass","jameson","titanium","cattle","unique","yeah","marine1","camilla","longjohn","kashmir","supreme","rogue","dogboy","valencia","book","jacques","legos","fishman","aaliyah","khan","woodie","mexican","ffffffff","demo","eastside","yyyyyyyy","asdf123","florida1","corey","woofer","jorge","score","clyde","bigcat","maximum","avenue","qwerasdf","buddyboy","jaybird","slick1","reynolds","gagged","daniels","india","sultan","point","bacchus","caprice","pyon","hookem","24680","skyhawk","1224","scorpio1","brittney","yolanda","pizzas","reptile","chippy","onetwo","cocker","iceberg","sleep","micro","carina","longdong","nine","jayhawks","stefanie","julie1","guess","diaper","postman","nemrac58","killbill","zippo","krusty","chantal","oblivion","compass","hopkins","venture","wowwow","jsbach","beacon","lowell","nitro","1master","sexman","laurent","fishhead","uranus","moonbeam","187187","shadows","merlin1","789789","lololo","dani","kiwi","stress","annabell","faithful","loser1","erika","bizzare","steffi","rockies","grandpa","sandrine","project","broncos1","warrior1","sloppy","annika","chips","macmac","cisco","whiskers","wolfpac","toad","canuck","vancouve","minemine","bigbob","spencer1","martine","romans","gotribe","fredrick","frost","pornporn","dentist","mother1","bigpimp","tommie","asians","chinese","osama","cornwall","hjkl","bluesman","smith1","jules","fenway","pornking","bongo","mopar","xxxxxx1","peggy","ariana","foxylady","doggy1","tosser","borders","kordell1","bergkamp","slater","middle","dirty1","troll","boomer1","viewsoni","shinobi","riders","hawaii50","flower1","papito","travis1","clifton","kelvin","1991","stan","jimjim","azsxdc","chelle","dominion","daddyo","wilder","jaguars","blaine","sheldon","mariner","antonia","callum","dogwood","nichole","kerry","insomnia","blunts","timeout","ridge","barbados","scissors","rams","dancing","monsters","biatch","sidekick","theatre","remingto","andersen","champ1","doors","raleigh","heinrich","1992","stoppedby","tender","root","cezer121","seabee","lookin","cwoui","kaylee","internal","skibum","temp123","revolver","616161","sail","logger","christmas","hogtied","wapapapa","talk","soccer12","ladder","angela1","chains","dummy","opendoor","davies","mildred","bigal","sixty9","phialpha","jolly","aviation","camaross","oldone","achtung","darklord","hugetits","1996","storage","splurge","joemama","rooney","57chevy","diva","trample","neutron","kisskiss","bigdick1","serious","lighting","rocco","bbbbbb1","calling","glasses","dimples","protect","cleopatr","burning","mohawk","bigjim","zzzzzz1","peaches1","list","102938","6464","canucks","rugby1","manga","colt","eighteen","2233","sixsix","playboy2","juniper","1228","catnip","girlies","locks","cory","hoffman","iforget","benny1","shodan","toni","jeeper","121314","allegro","878787","fudge","santafe","vaughn","novifarm","herring","mizzou","blanche","superstar","smile1","thebear","retire","676767","dunbar","pusssy","csfbr5yy","bumble","hogan","1bitch","talbot","playoffs","message","1026","camila","froggie","palmtree","uptown","nope","eclipse1","jaguar1","blitz","side","photon","mccarthy","greywolf","fister","dooley","qazwsxedc","crown","bobb","mulligan","1test","takehana","spjfet","thething","reed","andrey","goofball","canada1","gavin","downhill","punker","coolcat","bukowski","hitachi","waqw3p","bigred1","survey","shyshy","theshit","menthol","reveal","grimace","fool","dondon","primetime21","dempsey","buddy123","eatmenow","mousey","blair","zsmj2v","321123","pisser","therapy","redlight","auditt","464646","cheddar","gerhard","oscars","pwxd5x","colts","dagmar","ellis","2055","zw6syj","333666","slam","llamas","register","hamper","canine","fisherma","dogmeat","lydia","aaaaaaa1","danman","norbert","electro","klaatu","yogi","sexsexsex","paxton","lighthou","mate","asthma","4mnveh","gladys","sasasa","openit","trenton","noles1","ekim","mustang5","belair","stopit","shakes","pinto","jordon","1117","banana1","byron","glenda","digimon","queen1","aaabbb","cybersex","narnia","ewtosi","wiggle","jachin","zaqxsw","4343","pitcher","jimbeam","12345679","basher","gregory1","cheeky","fuzzy1","samdog","maine","vanessa1","d6wnro","nonenone","hillside","e5pftu","mouses","jarjar","yitbos","sweetness","shawnee","ploppy","jewell","amonra","515051","ggggg1","sayang","only","product","tramp","crash1","borabora","horse1","mommy1","beanbag","tailgate","shitshit","pfloyd","rewq","bagels","606060","geil","russel","donut","university","crazyman","nbvibt","bullwink","edition","verygood","belkin","sukebe","skeeter1","peddler","jeffjeff","robots","allnight","hcleeb","5757","farrell","dinger","lunchbox","poppy1","coaster","nevermin","holger","mistral","wendell","imback","blackcoc","393939","silicon","plokij","lincoln1","1202","baker1","8543852","fire1","sandberg","doqvq3","puddles","9898","climbing","booboo1","elektra","mocha","ilovegod","bertram","wrinkle5","shoot","pollux","topspin","midland","rockrock","archery","grammy","chas","gaelic","rulz","ov3ajy","prelude1","abbey1","cyprus","booyah","honeydew","eyphed"];

let emailRegex = /^[^.][a-zA-Z0-9!#$%&'*+-/=?^_`{|}~.]{1,64}@{1}[a-zA-Z0-9-.]{1,255}.[a-zA-Z0-9-.]{1,63}\.[a-zA-Z0-9]{1,63}$/; //REGEX FOR MATCHING EMAILS BASED ON THE EMAIL STRUCTURE DETAIL AT: https://en.wikipedia.org/wiki/Email_address
let passwordRegex = /^[a-zA-Z0-9!@#$%^&*(){}\[\]\\\/]*$/;

function emailUpdate()
{
	let emailElement = document.getElementById("email");
	let labelElement = document.getElementById("lblEmail");
	let email = emailElement.value;
	let matches = emailRegex.test(email);
	
	if(matches == true)
	{
		emailElement.style.backgroundImage = "url(\'../img/yes.png\')";
		labelElement.removeAttribute("class");
		labelElement.removeAttribute("tip");
		return true;
	}
	else
	{
		emailElement.style.backgroundImage = "url(\'../img/no.png\')";
		labelElement.setAttribute("class", "tooltip");
		labelElement.setAttribute("tip", "Invalid email address!");
		return false;
	}
}

function meetsCaseRequirements(password)
{
	let containsUpper = false;
	let containsLower = false;
	for(let i = 0; i < password.length; i++)
	{
		if(containsUpper == true && containsLower == true) //breaks loop if requirements are met before loop is finished
		{
			return true;
		}
		
		if(/[A-Z]/.test(password[i]) == true)
		{
			containsUpper = true;
		}
		else if(/[a-z]/.test(password[i]) == true)
		{
			containsLower = true;
		}
	}
	
	if(containsUpper == true && containsLower == true)
	{
		return true;
	}
	
	return false;
}

function inLengthRange(password)
{
	if(password.length > 5)
	{
		return true;
	}
	
	return false;
}

function inBlacklist(password)
{
	let pass = password.toLowerCase();
	for(let i = 0; i < blacklist.length; i++)
	{
		if(pass === blacklist[i].toLowerCase())
		{
			return true;
		}
	}
	
	return false;
}

function matchesRegex(password, regex)
{
	return regex.test(password);
}

function passwordUpdate()
{
	let passwordElement = document.getElementById("pswd");
	let labelElement = document.getElementById("lblPswd");
	
	let password = passwordElement.value;
	if(inLengthRange(password) == true)
	{
		console.log("IN RANGE");
		if(meetsCaseRequirements(password) == true)
		{
			console.log("MEETS CASE");
			if(inBlacklist(password) == false)
			{
				console.log("NOT IN BLACKLIST");
				if(matchesRegex(password, passwordRegex) == true)
				{
					console.log("MATCHES REGEX");
					passwordElement.style.backgroundImage = "url(\'../img/yes.png\')";
					labelElement.removeAttribute("class");
					labelElement.removeAttribute("tip");
					return true;
				}
				else
				{
					labelElement.setAttribute("class", "tooltip");
					labelElement.setAttribute("tip", "Password contains illegal characters! Valid characters are: a-z A-Z 0-9 !@#$%^&* (){}\[\]\\\/");
				}
			}
			else
			{
				labelElement.setAttribute("class", "tooltip");
				labelElement.setAttribute("tip", "Your password is known by hackers! Use another one!");
			}
		}
		else
		{
			labelElement.setAttribute("class", "tooltip");
			labelElement.setAttribute("tip", "Your password needs to have both an uppercase and a lowercase character!");
		}
	}
	else
	{
		labelElement.setAttribute("class", "tooltip");
		labelElement.setAttribute("tip", "Your password is too short! It needs to be 5+ characters in length!");
	}
	
	passwordElement.style.backgroundImage = "url(\'../img/no.png\')";
	return false;
}

function validate()
{
	if(passwordUpdate() == true && emailUpdate() == true)
	{
		return true;
	}
	else
	{
		alert("One or more required fields have not been correctly filled out!");
		return false;
	}
}